<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="/stylesheets/main.css" type="text/css" />
    <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" />
    <title>
        
            Type Safety for Python Functions - Aaron Schlesinger
        
    </title>
</head>

<body>
    <a href="http://github.com/arschles">
        <img style="position: absolute; top: 0; left: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png" alt="Fork me on GitHub" />
    </a>
    
    <h1 class="header_text"><a href="/">Aaron Schlesinger</a></h1>
    
    
        <div class="page_title">Type Safety for Python Functions</div>
    
    
    <div class="content">
        
<div id="post">
  <p>Have you ever written something like this Python code?</p>

<p>I find myself writing that all the time. I want the type flexibility of Python a lot of the time, but I also want to enforce types when I need to. Writing that if statement over and over at the top of all of your functions is not very DRY, and it's error prone and annoying. I solved that problem with a decorator.</p>

<h2>Function Decorators FTW</h2>

<p>Python decorators are functions that you tell Python to call &amp; pass another function into it. Python will replace the passed function with whatever your decorator function returns. Here's a concrete example:</p>

<p>Python calls the log function only once before I call myFunction for the first time. When it calls log, it passes it myFunction. When log returns, Python replaces myFunction with its return value, so that whenever I write code to call myFunction, I'm actually calling whatever log returned.</p>

<p>Every decorator has to return an object that's callable (ie: a function or an object with the <strong>call</strong> method implemented) in order for this whole thing to work. Here, I've got log returning a function that takes in any number of arguments, prints some stuff, calls the original function with the arguments that were passed to it, and then prints some more stuff. Simple but powerful. You can now hijack any function without the caller knowing.</p>

<h2>Checking Types</h2>

<p>The decorator for checking types is a bit more complex, but follows the same rules as the simpler one above. Here it is:</p>

<p>This decorator is more code because it takes in the expected types (in an argument list), and then must return another function that itself takes in printCoords. That second function has to return the function that will replace printCoords. The type checking happens inside of the innermost function (creatively called inner).</p>

<p>Using this decorator introduces a performance hit because it has to check the types of each argument every time printCoords is called (such is life with an interpreted, dynamically typed language), so if you don't like that, turn this decorator on in debugging environments only. In all other environments, it can just pass directly through and return the original function.</p>

<h2>More Decorators</h2>

<p>Decorators can do tons of stuff. They effectively provide a means to filter any function once before it's called the first time. You can use decorators to implement some pretty wide reaching changes with very little code and no refactoring. I'll cover some more uses in my next post.</p>

<p>For now, check out the Python Decorator Library (which includes a more complete implementation of this type checking decorator): http://wiki.python.org/moin/PythonDecoratorLibrary</p>

</div>

<div class="top_space"></div>
<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
    </div>
    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-25255506-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
</body>
</html>